# Railway Node Version Fix - Complete Solution

## Problem Identified
Railway is using Node.js 18.20.5, but your dependencies require Node 20+. The error shows:
- `npm warn EBADENGINE required: { node: '>=20' }`
- `npm ci` failing due to engine requirements

## Solution: Updated Configuration Files

### **1. nixpacks.toml** (Already Updated)
```toml
[phases.setup]
nixPkgs = ['nodejs_20', 'npm-9_x']

[phases.install]
cmds = ['npm ci --legacy-peer-deps']

[phases.build]
cmds = ['npm run build']

[start]
cmd = 'npm start'

[variables]
NODE_VERSION = '20.11.0'
```

### **2. Railway Environment Variables**
Add these to your Railway project:
```
NODE_VERSION=20.11.0
NODE_ENV=production
PORT=5000
DATABASE_URL=[Auto-generated by Railway PostgreSQL]
PGDATABASE=railway
PGHOST=[Auto-generated by Railway PostgreSQL]
PGPASSWORD=[Auto-generated by Railway PostgreSQL]
PGPORT=[Auto-generated by Railway PostgreSQL]
PGUSER=postgres
STRIPE_SECRET_KEY=sk_test_[your_key]
VITE_STRIPE_PUBLIC_KEY=pk_test_[your_key]
```

### **3. Alternative: Dockerfile Approach**
If nixpacks.toml doesn't work, create this Dockerfile:
```dockerfile
FROM node:20.11.0

WORKDIR /app

COPY package*.json ./
RUN npm ci --legacy-peer-deps

COPY . .
RUN npm run build

EXPOSE 5000

CMD ["npm", "start"]
```

## Upload Steps
1. **Push updated nixpacks.toml to GitHub** (already done)
2. **Create new Railway service**
3. **Connect GitHub repository**
4. **Add PostgreSQL database**
5. **Set environment variables**
6. **Deploy**

## Expected Result
- Node.js 20 enforced
- Dependencies install successfully
- Build generates index-B9yXiVfA.js
- API runs at your-app.up.railway.app
- Smart backend detection works

## If Still Failing
Try the Dockerfile approach - create the Dockerfile above and Railway will automatically detect and use it instead of nixpacks.toml.

This should resolve the Node version compatibility issue and get Railway working like last night!